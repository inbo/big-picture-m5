---
title: "Data preparation from Survey Monkey"
author: "Lynn Pallemaerts"
date: "2025-01-07"
output:
  html_document: default
---

# Libraries

```{r}
library(devtools)
devtools::install_github("mattroumaya/surveymonkey")
library(tidyverse)
```

# Connect with Survey monkey

```{r}
m5_survey <- surveymonkey::browse_surveys(title = "Indentifying data sharing issues regarding camera trap data in Europe -- dummy version",
                                          oauth_token = sm_oauth_token)
survey_ID <- c(m5_survey$id)

# Get whole survey
survey <- surveymonkey::fetch_survey_obj(survey_ID,
                                         oauth_token = sm_oauth_token)
survey_df <- surveymonkey::parse_survey(survey,
                                        oauth_token = sm_oauth_token) %>%
  surveymonkey::strip_html()
```

# Get question list

```{r}
qs <- read_delim("./Input/question_list_dummy.csv",
                 delim = ";")
```

# Basic data exploration

```{r}
# Get number of total respondents
length(unique(survey_df$respondent_id))

# Get number of complete responses
resp <- survey_df %>%
  select(-survey_id, -collector_id, -date_created, -date_modified) %>%
  filter(response_status == "completed") %>%
  select(-response_status)
length(unique(resp$respondent_id))
```

# Make subset for each question

```{r}
for (i in 1:nrow(qs)) {
  name <- qs$code[i]
  question <- qs$question[i]
  assign(name, 
         survey_df %>%
           dplyr::select(respondent_id, contains(question)))
}
remove(i, name, question)
```

# Clean individual dataframes













# Get survey ID

```{r}
surv <- surveymonkey::browse_surveys(title = "Indentifying data sharing issues regarding camera trap data in Europe -- dummy version",
                                     oauth_token = token)
survID <- c(surv$id)
```

# Get the whole survey

```{r}
fullSurvey <- surveymonkey::fetch_survey_obj(survID,
                                             oauth_token = token) # your survey's ID goes here
```

# Get only responses

```{r}
responses <- surveymonkey::parse_survey(fullSurvey,
                                        oauth_token = token)
responses <- responses %>%
  surveymonkey::strip_html()
```
